stages:
  - update_docs

update_getting_started:
  stage: update_docs
  image: alpine:latest
  before_script:
    - apk add --no-cache git
  script:
    - git clone https://gitlab-ci-token:${CI_JOB_TOKEN}@gitlab.com/coinmetrics/research/cm_demo_assets.git
    - git clone https://gitlab-ci-token:${CI_JOB_TOKEN}@gitlab.com/coinmetrics/front-end/knowledge-base.git
    - cp -r cm_demo_assets/getting-started/* knowledge-base/docs/getting-started/
    - cd knowledge-base
    - BRANCH_NAME="update-getting-started-docs-$(date +%Y%m%d-%H%M%S)"
    - git checkout -b $BRANCH_NAME
    - git config user.name "Data Encyclopedia Updater"
    - git config user.email "no-reply@coinmetrics.io"
    - git add docs/getting-started
    - git commit -m "Update getting-started docs from cm_demo_assets"
    - git push -o merge_request.create -o merge_request.target=master -o merge_request.title="Update getting-started docs from cm_demo_assets" origin $BRANCH_NAME
  # only:
  # - master
#  when: manual
  tags:
    - coinmetrics-build-runner
    - linux
    - docker
