# Order Book Depth

## Definition

Liquidity depth metrics measure the available order book liquidity at different percentage levels from the midprice. These metrics provide measure the market depth and assess how much volume is available for trading at different price levels. The metrics are computed in both the native units of the base asset for spot markets and in contract values for futures markets, and their equivalent value in USD.

<table><thead><tr><th width="264">Name</th><th width="378">MetricID</th><th>Unit</th><th>Interval</th></tr></thead><tbody><tr><td>Order Book Depth, 0.1 Percent From Midprice, Ask, Native Units</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_0_1_percent_ask_volume_units">liquidity_depth_0_1_percent_ask_volume_units</a></td><td>Native Units</td><td>1h</td></tr><tr><td>Order Book Depth, 1 Percent From Midprice, Ask, Native Units</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_1_percent_ask_volume_units">liquidity_depth_1_percent_ask_volume_units</a></td><td>Native Units</td><td>1h</td></tr><tr><td>Order Book Depth, 2 Percent From Midprice, Ask, Native Units</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_2_percent_ask_volume_units">liquidity_depth_2_percent_ask_volume_units</a></td><td>Native Units</td><td>1h</td></tr><tr><td>Order Book Depth, 5 Percent From Midprice, Ask, Native Units</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_5_percent_ask_volume_units">liquidity_depth_5_percent_ask_volume_units</a></td><td>Native Units</td><td>1h</td></tr><tr><td>Order Book Depth, 10 Percent From Midprice, Ask, Native Units</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_10_percent_ask_volume_units">liquidity_depth_10_percent_ask_volume_units</a></td><td>Native Units</td><td>1h</td></tr><tr><td>Order Book Depth, 0.1 Percent From Midprice, Ask, USD</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_0_1_percent_ask_volume_usd">liquidity_depth_0_1_percent_ask_volume_usd</a></td><td>USD</td><td>1h</td></tr><tr><td>Order Book Depth, 1 Percent From Midprice, Ask, USD</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_1_percent_ask_volume_usd">liquidity_depth_1_percent_ask_volume_usd</a></td><td>USD</td><td>1h</td></tr><tr><td>Order Book Depth, 2 Percent From Midprice, Ask, USD</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_2_percent_ask_volume_usd">liquidity_depth_2_percent_ask_volume_usd</a></td><td>USD</td><td>1h</td></tr><tr><td>Order Book Depth, 5 Percent From Midprice, Ask, USD</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_5_percent_ask_volume_usd">liquidity_depth_5_percent_ask_volume_usd</a></td><td>USD</td><td>1h</td></tr><tr><td>Order Book Depth, 10 Percent From Midprice, Ask, USD</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_10_percent_ask_volume_usd">liquidity_depth_10_percent_ask_volume_usd</a></td><td>USD</td><td>1h</td></tr><tr><td>Order Book Depth, 0.1 Percent From Midprice, Bid, Native Units</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_0_1_percent_bid_volume_units">liquidity_depth_0_1_percent_bid_volume_units</a></td><td>Native Units</td><td>1h</td></tr><tr><td>Order Book Depth, 1 Percent From Midprice, Bid, Native Units</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_1_percent_bid_volume_units">liquidity_depth_1_percent_bid_volume_units</a></td><td>Native Units</td><td>1h</td></tr><tr><td>Order Book Depth, 2 Percent From Midprice, Bid, Native Units</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_2_percent_bid_volume_units">liquidity_depth_2_percent_bid_volume_units</a></td><td>Native Units</td><td>1h</td></tr><tr><td>Order Book Depth, 5 Percent From Midprice, Bid, Native Units</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_5_percent_bid_volume_units">liquidity_depth_5_percent_bid_volume_units</a></td><td>Native Units</td><td>1h</td></tr><tr><td>Order Book Depth, 10 Percent From Midprice, Bid, Native Units</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_10_percent_bid_volume_units">liquidity_depth_10_percent_bid_volume_units</a></td><td>Native Units</td><td>1h</td></tr><tr><td>Order Book Depth, 0.1 Percent From Midprice, Bid, USD</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_0_1_percent_bid_volume_usd">liquidity_depth_0_1_percent_bid_volume_usd</a></td><td>USD</td><td>1h</td></tr><tr><td>Order Book Depth, 1 Percent From Midprice, Bid, USD</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_1_percent_bid_volume_usd">liquidity_depth_1_percent_bid_volume_usd</a></td><td>USD</td><td>1h</td></tr><tr><td>Order Book Depth, 2 Percent From Midprice, Bid, USD</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_2_percent_bid_volume_usd">liquidity_depth_2_percent_bid_volume_usd</a></td><td>USD</td><td>1h</td></tr><tr><td>Order Book Depth, 5 Percent From Midprice, Bid, USD</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_5_percent_bid_volume_usd">liquidity_depth_5_percent_bid_volume_usd</a></td><td>USD</td><td>1h</td></tr><tr><td>Order Book Depth, 10 Percent From Midprice, Bid, USD</td><td><a href="https://coverage.coinmetrics.io/market-metrics-v2/liquidity_depth_10_percent_bid_volume_usd">liquidity_depth_10_percent_bid_volume_usd</a></td><td>USD</td><td>1h</td></tr></tbody></table>

## Details

The liquidity depth metrics follow a structured naming convention:

* **`liquidity_depth_{X}_percent_ask_volume_units`**: Order book depth on the ask side at X% of midprice in base asset units.
* **`liquidity_depth_{X}_percent_bid_volume_units`**: Order book depth on the bid side at X% of midprice in base asset units.
* **`liquidity_depth_{X}_percent_ask_volume_usd`**: Order book depth on the ask side at X% of midprice converted to USD.
* **`liquidity_depth_{X}_percent_bid_volume_usd`**: Order book depth on the bid side at X% of midprice converted to USD.

Each liquidity depth metric represents the cumulative volume available on either the bid or ask side of the order book at a specified percentage away from the midprice.

* The midprice is defined as the average of the best bid and best ask prices:\
  \
  $$\text{Midprice} = \frac{\text{Best Bid Price} + \text{Best Ask Price}}{2}$$\

* The total volume available on the order book at or within X% of the midprice, expressed in the base asset’s native units for spot markets and contract units for futures markets:\
  \
  $$\text{Liquidity Depth}_{X\%} = \sum_{p \geq P_{\text{mid}} (1 - X\%)} V_{\text{bid}}(p)  \quad \text{(for bids)}$$\
  $$\text{Liquidity Depth}_{X\%} = \sum_{p \leq P_{\text{mid}} \times (1 + X\%)} V_{\text{ask}}(p)  \quad \text{(for asks)}$$\

* The total volume available on the order book at or within X% of the midprice, expressed in U.S. dollars for spot markets:\
  \
  $$\text{Liquidity Depth}_{X\%, USD} = \sum_{p \geq P_{\text{mid}} \times (1 - X\%)} V_{\text{bid}}(p) \times P_{\text{bid}}  \quad \text{(for bids)}$$\
  $$\text{Liquidity Depth}_{X\%, USD} = \sum_{p \leq P_{\text{mid}} \times (1 + X\%)} V_{\text{ask}}(p) \times P_{\text{ask}}  \quad \text{(for asks)}$$\

* Futures markets follow a modified formula that takes into account the contract size:\
  \
  $$\text{Liquidity Depth}_{X\%, USD} = \sum_{p \geq P_{\text{mid}} \times (1 - X\%)} V_{\text{bid}}(p) \times \text{Contract Size} \times P_{\text{ContractSizeAsset,USD}}  \quad \text{(for bids)}$$\
  $$\text{Liquidity Depth}_{X\%, USD} = \sum_{p \geq P_{\text{mid}} \times (1 + X\%)} V_{\text{ask}}(p) \times \text{Contract Size} \times P_{\text{ContractSizeAsset,USD}}  \quad \text{(for asks)}$$\
  $$\text{Liquidity Depth}_{X\%, USD} = \sum_{p \geq P_{\text{mid}} \times (1 + X\%)} V_{\text{ask}}(p) \times \text{Contract Size} \times P_{\text{ContractSizeAsset,USD}}  \quad \text{(for asks)}$$

## API Endpoints

Liquidity order book depth metrics can be accessed using the following endpoints:

* `timeseries/market-metrics`

{% openapi src="../../../.gitbook/assets/openapi.yaml" path="/timeseries/market-metrics" method="get" %}
[openapi.yaml](../../../.gitbook/assets/openapi.yaml)
{% endopenapi %}

{% tabs %}
{% tab title="Shell" %}
```shell
curl --compressed "https://api.coinmetrics.io/v4/timeseries/market-metrics?markets=coinbase-btc-usd-spot&metrics=liquidity_depth_2_percent_ask_volume_units&frequency=1h&limit_per_market=1&api_key=<your_key>"
```
{% endtab %}

{% tab title="Python" %}
```python
import requests
response = requests.get('https://api.coinmetrics.io/v4/timeseries/market-metrics?markets=coinbase-btc-usd-spot&metrics=liquidity_depth_2_percent_ask_volume_units&frequency=1h&limit_per_market=1&api_key=<your_key>').json()
print(response)
```
{% endtab %}

{% tab title="Python Client" %}
```python
from coinmetrics.api_client import CoinMetricsClient

api_key = "<API_KEY>"
client = CoinMetricsClient(api_key)

print(
    client.get_market_metrics(
        markets=["coinbase-btc-usd-spot"], metrics=['liquidity_depth_2_percent_ask_volume_units'], frequency='1h', limit_per_market=1
    ).to_dataframe()
)
```
{% endtab %}
{% endtabs %}

## Examples

A sample of the Order Book Depth, 2 Percent From Midprice, Ask, Native Units for the Coinbase BTC-USD spot market is shown below:

```
{
  "data" : [ {
    "market" : "coinbase-btc-usd-spot",
    "time" : "2023-05-04T20:00:00.000000000Z",
    "liquidity_depth_2_percent_ask_volume_units" : "9866859.984315595"
  }, {
    "market" : "coinbase-btc-usd-spot",
    "time" : "2023-05-04T21:00:00.000000000Z",
    "liquidity_depth_2_percent_ask_volume_units" : "10170729.085314134"
  }, {
    "market" : "coinbase-btc-usd-spot",
    "time" : "2023-05-04T22:00:00.000000000Z",
    "liquidity_depth_2_percent_ask_volume_units" : "10909944.294472648"
  }, {
    "market" : "coinbase-btc-usd-spot",
    "time" : "2023-05-04T23:00:00.000000000Z",
    "liquidity_depth_2_percent_ask_volume_units" : "10983104.902848331"
  }, {
    "market" : "coinbase-btc-usd-spot",
    "time" : "2023-05-05T00:00:00.000000000Z",
    "liquidity_depth_2_percent_ask_volume_units" : "11103789.859471431"
  } ]
}
```

* **`market`**: The id of the markets.
* **`time`**: The time in ISO 8601 date-time format.
* **`liquidity_depth_2_percent_bid_volume_usd`**: The sum of all bid orders with price within 2 percent from midprice in native units.

## Frequently Asked Questions

### **Why are some of the values for some order book depth metrics and observations missing?**

Coin Metrics calculates order book depth metrics from order book snapshots obtained from centralized exchanges. Coin Metrics will obtain the deepest and most complete order book snapshot that the exchange offers — however, the order book depth allowed varies by exchange.

If the order book depth for a market is insufficient to calculate a particular order book depth metric at X% from midprice, Coin Metrics will assign a null value to the observation. The null value was chosen instead of using the available depth to calculate a value (even if the order book depth is insufficient to calculate a value at X% from midprice), to provide transparecy to the user that the order book depth is too shallow. If a non-null value is desired, it is recommended to select a metric with a smaller X% from midprice.

For more information on the available order book depth by exchange, please see [**Are there any limitations to the order book depth provided by each exchange?**](https://docs.coinmetrics.io/market-data/market-data-overview/market-order-book#are-there-any-limitations-to-the-order-book-depth-provided-by-each-exchange) Please note that some exchanges only provide an order book with very shallow depth, such as the top 100 levels. Therefore, a large number of nulls can be expected from markets from these exchanges.

### How often are the metrics calculated?

The depth metrics are calculated once an hour.

## Release History

* **Release Version. Market Data Feed v2.8 on May 2023**.
